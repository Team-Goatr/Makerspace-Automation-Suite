<?php

// Preventing loading direct from browser
defined( 'ABSPATH' ) or die();

echo '<link rel="stylesheet" type="text/css" href="' . plugins_url( 'admin-members-edit.css', __FILE__ ) . '">' . "\n";

include dirname(__DIR__).'../../../resources/GSuiteAPI.php';
include dirname(__DIR__).'../../../resources/StripeAPI.php';

$user = getUser($_GET['email']);

?>
		<table class="mas">
			<tr>
				<th colspan="3" class="mas">
					<div id="breadcrumb" class="mas-breadcrumb">
                        <a href="admin.php?page=mas-plugin&content=1" class="mas">Members</a> >> <?php echo $user->getName()->getFullName();?>
					</div>
				</th>
			</tr>

			<tr>
				<td class="mas">	
					<form>

					  <div id="name">
					    <label for="firstName" class="mas">First Name:</label>
					    <input type="text" id="firstName" name="firstName" class="mas" value="<?php echo $user->getName()->getGivenName();?>">
					    <br>

					    <label class="mas">Last Name:</label>
					    <input type="text" id="lastName" name="lastName" class="mas" value="<?php echo $user->getName()->getFamilyName();?>">
					  </div>
					</form>
                    <br>
                    <form action="<?php echo admin_url( 'admin-post.php' ); ?>" method="POST">
                        <input type="hidden" value="<?php 
                            $sub_mgmt = $user->getCustomSchemas()['Subscription_Management'];
                            $stripe_id = !empty($sub_mgmt['Stripe_ID']) ? $sub_mgmt['Stripe_ID'] : '';
                            echo $stripe_id; ?>" name="customer-id">
                        <input type="hidden" value="update_card" name="action">
                        <?php getStripeUpdateCard($_GET['email']); ?>
                    </form>
				</td>

				<td class="mas">
					<?php
						echo '<img class="mas" src="' . plugins_url( '../../../images/female-placeholder.png', __FILE__ ) . '" id="profilePic" alt="Profile Picture">' . "\n";
					?>
					<br> 
					<button class="mas-save" type="submit">Save Changes</button>
				</td>

			</tr>

		</table>
